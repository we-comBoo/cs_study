## 쿠키

### 등장 배경

### 정의
브라우저에 저장되는 key와 value로 이루어진 작은 크기의 문자열

### 특징
* HTTP 요청 시 따로 설정하지 않아도 자동으로 전달 가능
* 만료 시간 설정 가능
* 4KB 크기 제한

### 활용 예시
* 로그인 유지
* n일 동안 보지 않기
    ```javascript
    document.cookie = `modalClose=true; path=/; expires=${new Date(Date.now() + n * 24 * 60 * 60 * 1000).toUTCString()}`;
    ```

### 단점
* HTTP 요청시 모든 쿠키가 자동으로 전달됨에 따른 불필요한 트래픽 증가
* 4KB 적은 용량
* XSS 공격 및 XSRF 공격에 취약

### 해결 방법
1. XSS 공격 대응

    HttpOnly 속성 
    * 자바스크립트로 쿠키 조회 방지

2. XSRF 공격 대응

    SameSite 속성 
    * Strict: 사이트와 같은 도메인 요청에만 쿠키를 전송
    * Lax: 안전한 메서드, 작업이 최상위 레벨 Navigation에서 이뤄지는 경우 다른 도메인이라도 쿠키 전송

3. Secure 속성

    * HTTPS로 통신하는 경우에만 쿠키 전송


---

## XSS 공격

## XSRF 공격


---


## 웹 스토리지

### 정의
HTML5부터 지원하는 브라우저에 데이터 저장할 수 있는 API

### 특징
1. 자동으로 서버에 전송 되지 않음 (쿠키의 트래픽 문제 해경)
2. 오리진 단위로 접근 제한 (CSRF로부터 안전)
3. 5MB 정보 저장 가능

### 로컬 스토리지 vs 세션 스토리지

|구분|로컬 스토리지|세션 스토리지|
|:--:|:--:|:--:|
|저장범위|도메인 별| 도메인 별/탭 별|
|삭제 기준| 직접 삭제 시|브라우저나 탭을 닫을 시|
|활용 예시| 글 임시 저장 / 사용자 설정 저장|입력폼 저장 / 일회성 로그인|

### 단점
1. 만료 기간 설정 불가
2. 동기적으로 실행됨 

    메인 스레드 블로킹 문제 발생 가능
    (용량이 큰 데이터를 저장하는 경우, 비동기적으로 실행되는 IndexedDB 고려)
3. XSS 공격에 취약함

    사용자 입력이 JS 코드로 실행될 수 있는 코드 작성 X
4. 미지원하는 브라우저에 대한 에러 처리 필요 (사파리 시크릿 모드)

---
## 어디에 저장하는게 제일 좋을끼?

1. 로컬 스토리지
* XSS에 취약한 편
* XSRF에 안전한 편
* 따로 서버에서 설정해주지 않아도 됨 

2. 쿠키
* XSS에 안전한 편
* XSRF에 취약한 편
* 매번 서버로 요청에 담하야하는 JWT와 쿠키의 특징 유사함
* XSRF보다 XSS 공격이 다루기 더 힘들기 때문에 쿠키 사용

3. 기준
* 매번 요청을 할 때마다 필요한 데이터인가?
* 저장하는 데이터의 용량은 어느정도인가?
* 만료기간은 필요한가?
* 나의 페이지는 어떤 보안에 취약한가?



----
### 쿠키
사용자에 의해 조작되어도 크게 문제 되지 않을 정보를 브라우저에 저장


### 세션
인증에 대한 정보를 서버가 저장


### 토큰
인증에 대한 정보를 사용자가 저장


### 캐시
한 번 전송 받은 데이터를 저장해 놨다가 필요할 때 꺼내 쓰기 가능