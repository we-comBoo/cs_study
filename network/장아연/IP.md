## 패킷 교환 방식
* 패킷을 이용해 정보를 교환하는 방식
* 데이터를 패킷 단위로 나누어 전달 

## 패킷 교환 방식 사용 이유
1. 자원 낭비 방지 <br/>
* 무거운 데이터를 그대로 전송하는 경우, 도중에 문제 발생 시 해당 전체 데이터를 다시 보내기 위해 많은 자원을 사용해야 할수도 있음
2. 효율적인 경로 선택 <br/>
* 패킷별로 최적의 경로 선택해 이동
* 특정 경로에 문제 발생해도 다른 경로로 이동하는 패킷은 안정적으로 도착가능

## IP
1. Internet Protocol
* 패킷을 정해진 목적지까지 운반하기 위해 사용하는 통신 규약
2. 역할
* 패킷을 정해진 목적지까지 전달하는 역할
3. 특징
* 비연결성 : 패킷의 목적지 존재 여부 보장하지 않음
* 비신뢰성 : 패킷의 상태를 보장하지 않음
4. IP 주소
* 패킷의 목적지 구분자 역할
5. IP 주소 확인하는 방법
* 구글에 "what is my ip?" 검색
* 커맨드 창에 `ipconfig` 또는 `ifconfig` 검색
* 한국인터넷진흥원에서 인터넷주소 정보 검색 서비스를 통해 IP 주소 검색해 해당 IP 주소 사용자의 신원/소속 확인 가능

## IPv4
1. 구조
* 32bit
* 4옥텟 구성
* 각 옥텟의 범위 :  0(00000000) ~ 255(11111111)

2. 네트워크 주소 & 호스트 주소
* 네트워킹 
    ```
    데이터를 통신하는 과정에서 같은 공유기를 사용하는 범위
    가장 먼저 해당 컴퓨터가 속한 네트워크 진입을 위한 구분자
    ex> 서울시 네트동 워크빌라
    ```

* 호스트 
    ```
    네트워크에 연결된 각각의 장치 
    해당 네트워크 내 특정 호스트를 찾기 위한 구분자 
    ex> 102호
    ```

* 호스트 부분에서 불가능한 주소 2가지
    ```
    0 : 네트워크 그 자체 주소
    255 : 브로드캐스트 주소
    ``` 

3.  브로드캐스트 주소란?
특정 네트워크 내 모든 호스트에게 패킷을 전달해야할 때 사용하는 주소


## IP 주소 클래스
1. 등장 배경 <br/>
* 네트워크 부분과 호스트 부분은 고정되지 않음! <br/>
* 네트워크 부분과 호스트 부분의 유동적인 조절을 위해 클래스 도입
    - 호스트 많은 조직 : 한개의 IP 주소만으로 불충분해 여러개의 IP 주소 사용
    - 호스트 적은 조직 : 사용하지 않아 낭비되는 호스트 주소가 생김 

2. A 클래스
* 첫번째 옥텟 : 네트워크, 두번째 ~ 네번째 옥텟 : 호스트
* 호스트가 가장 많은 클래스
* 첫번째 옥텟 범위 : 0으로 시작 | 0 ~ 127
* 127은 자기 자신을 의미하는 loopback으로 실제 범위는 0 ~ 126
3. B 클래스
* 첫번째 ~ 두번째 옥텟 : 네트워크, 세번째 ~ 네번째 옥텟 : 호스트
* 첫번째 옥텟 범위 : 10으로 시작 | 128 ~ 191
4. C 클래스
* 첫번째 ~ 세번째 옥텟 : 네트워크, 네번째 옥텟 : 호스트
* 첫번째 옥텟 범위 : 110으로 시작 | 192 ~ 223
5. D 클래스
* 멀티캐스트
6. E 클래스 
* 예약

7. 예시
    ```
    IP 주소 : 130.101.12.124

    첫번째 옥텟 130 -> B클래스 
    네트워크 주소 : 130.101 -> 첫번째 ~ 두번째 옥텟
    호스트 주소 : 12.124 -> 세번째 ~ 네번째 옥텟
    ```
8. 클래스 한계 
**B 클래스 급속도로 소진됨** 
* 이유 : 클래스 별로 할당할 수 있는 호스트 갯수가 한정적이고 클래스에 따라 그 갯수의 차이가 크기 때문임. 대부분의 사이트가 클래스 C를 들어가기엔 크다 보니 클래스 B를 할당 받음 
* ~~3가지 객관식 선택 (A, B, C)만 존재~~

## IPv4 고갈 문제 발생
* IPv4 주소 체계에서 사용 가능한 IP 주소는 약 43억개
* 80년 대 소수의 사람만 컴퓨터를 사용했지만 이후 가정 내 PC 보급과 IoT 보급에 따라 IP 주소 소진이 가속화됨


## 효율적인 IP 주소 할당 - CIDR/서브넷마스크 & DHCP
### CIDR
1. 정의
* Classless Inter-Domain Routing | 사이더 | 클래스 없는 도메인 간 라우팅
2. 클래스보다 효율적인 이유<br/>
    ```
    옥텟 단위로 네트워크 부분과 호스트 부분을 분리하는 클래스와 달리
    CIDR는 비트 단위로 네트워크 부분과 호스트 부분을 분리하기 때문에 
    기존 클래스 방식보다 더 잘게 IP 주소를 쪼개 사용함에 따라 
    사용자들은 필요한 호스트 개수만큼만 호스트 할당받아 사용 가능 
    ~~ 자유로운 주관식 선택 (필요한 호스트 갯수 쓰기) ~~
    ```
3. 비트 단위로 네트워크 부분과 호스트 부분 구분
    ```
    Q. 다음의 IP 주소에서 1000개 정도의 호스트가 필요한 경우, 네트워크 부분과 호스트 부분 분리
    10진수 : 192.168.10.1
    2진수 : 11000000.10101000.00001010.00000001

    A. 
    -> 2의 10승 = 1024 
    -> 뒤에서부터 10bit 부분인 10.00000001 : 호스트 부분
    -> 나머지 앞의 22bit 부분인 11000000.10101000.000010 : 네트워크 부분
    ```
4. 서브넷 마스크
* 32bit
* IP 주소의 네트워크 부분과 호스트 부분 구분할 수 있게 하는 역할
* 네트워크 부분 : 1이 연속한 자릿수 부분
* 호스트 부분 : 0이 있는 자릿수 부분
    ```
    Q. 주어진 서브넷 마스크에 대해 다음의 IP 주소에서 네트워크 부분과 호스트 부분을 구분해라
    10진수 : 192.168.10.1
    2진수 : 11000000.10101000.00001010.00000001
    서브넷마스크 : 255.255.255.0

    A. 
    IP 주소    : 11000000.10101000.00001010.00000001
    서브넷마스크 : 11111111.11111111.11111111.00000000
    
    호스트 부분 | IP 주소 영역에서 서브넷마스크가 연속적으로 0인 부분 
    -> 1 (00000001) 
    네트워크 부분 | IP 주소 영역에서 서브넷마스크가 연속적으로 1인 부분 
    -> 192.168.10 (11000000.10101000.00001010) 
    ```
5. CIDR 표기법
* 원래 IP 주소 / 서브넷 마스크의 연속적인 1의 자릿수
    ```
    Q. 주어진 서브넷 마스크에 대해 다음의 IP 주소를 CIDR 표기법으로 작성
    10진수 : 192.168.10.1
    2진수 : 11000000.10101000.00001010.00000001
    서브넷마스크 : 255.255.255.0

    A. 
    IP 주소    : 11000000.10101000.00001010.00000001
    서브넷마스크 : 11111111.11111111.11111111.00000000
    
    네트워크 부분의 연속적인 1의 자릿수 = 24
    => 192.169.10.1/24
    ```
### DHCP

1. 고정 IP와 유동 IP 
    |고정 IP|유동 IP|
    |:--:|:--:|
    |고정적으로 같은 IP 사용|고정되어 있지 않고 상황에 따라 바뀌는 IP 사용|
    |독서실에서 맨날 지정석인 본인 자리에 착석|도서관에서 그때 그때 빈자리에 착석|
    |사용하는 통신사의 ISP에 요청해 할당 받으며 주로 서버 운영 등 특수한 경우|대부분 ISP에서 제공하는 유동 IP 주소 사용|
2. 동적으로 IP주소를 부여하고 관리하는 프로토콜
3. 동적인 IP 주소 할당 과정 - 갱신 없는 경우
    ```
    1. 컴퓨터의 IP 주소에 대한 요청
    2. DHCP 서버가 현재 할당 가능한 IP 주소 탐색
    3. IP 주소와 임대 기간(주로 8일, 유동적 설정 가능) 제공해 할당해 줌
    4. 임대 기간 종료 또는 IP 주소 사용하지 않으면 컴퓨터가 DHCP 서버에 IP 주소 반환
    ```
4. 동적인 IP 주소 할당 과정 - 갱신 요청하는 경우
    ```
    주소 임대 신청 : 1월 1일 
                ---임대 기간 8일---> 반환 예정일 : 1월 9일 
    갱신 요청 : (임대 기간 끝나기 전인) 1월 5일 ---갱신 성공---> 
            ---임대 기간 8일---> 반환 예정일 : 1월 13일
    ```
## IP 주소 갯수 늘리기 - 공인IP/사설IP/NAT

1. 공인 IP와 사설 IP 
    |공인 IP|사설 IP|
    |:--:|:--:|
    |인터넷 상 유일한 주소|다른 네트워크끼리는 고유하지 않음|
    |-|자신이 속하ㄴ 네트워크 내에서 고유함|
    |ISP에서 공식적으로 할당|특정 네트워크 내 사적인 용도로 활용|
    |건물 주소 (아파트 이름)|상세 주소 (동호수)|

* 특정 네트워크 별로 고유한 IP는 한개씩만 가져가되, 그 네트워크 안에 호스트는 따로 가상 IP 주소를 할당해 서로 구분 가능
* 사설 IP는 본인이 속한 네트워크에서만 고유해 외부 네트워크에서 사설 IP 사용 시 혼선 발생할 수 있어 공식적으로 정해진 대역 내에서만 사용 가능
* 사설 IP는 192.168로 시작함
* NAT을 활용해 중복되는 사설 IP를 가지고도 다른 컴퓨터와 통신 가능

2. NAT
* Network Address Translation
* IP 주소를 다른 IP 주소로 변환하는 기술로 공유기에 탑재됨

3. NAT을 이용한 사설 IP에서 공인 IP로 변환 과정
    ```
    1. 사용자 컴퓨터에서 영상 시청 요청 메세지 전송
    2. 공유기가 해당 메세지 수신
    3. 공유기는 NAT 이용해 사설 IP 주소였던 요청의 수신지 주소를 공인 IP로 변경함. 
    4. NAT 테이블에 어떤 사설 IP를 어떤 공인 IP로 변경했는지 기록함. 
       why? 데이터가 서버로부터 들어온 경우, 해당 요청의 응답을 사설 IP 사용자에게 전달해야하기 때문
    5. 요청을 받은 영상 플랫폼 서버는 NAT이 바꿔놓은 공인 IP 주소로 해당 데이터 전송
    6. NAT이 도착한 데이터 확인
    7. NAT이 NAT 테이블에서 데이터의 도착지인 공인 IP와 일치하는 사설 IP로 해당 데이터 전달
     ```

4. 보안적 측면
* 외부에서 내부 네트워크 주소 체계 파악 불가능

## 차세대 IP - IPv6

|-|IPv4|IPv6|
|:--:|:--:|:--:|
|주소 길이|32bit|128bit|
|주소 갯수|2^32|2^128|
|주소|192.168.0.1|2001:0db8:85a3:1319:8a2e:0307:77334|
|진수|8진수|16진수|
|구분 단위|옥텟과 점 (.) | 2옥텟과 콜론 (:)|
|NAT | 지원 O|지원 X|

* 기존의 IPv4와 다른 체계의 IPv6 사용을 위해 네트워크 구축이 요구되어 사용률 저조함
----
## ⭐ IPv4 주소 고갈을 해결하는 방안
1. CIDR와 서브넷 마스크 <br/>
네트워크 부분과 호스트 부분의 구분점을 1비트 단위까지 가능하게 해 유연한 호스트 주소 할당 가능
1. DHCP <br/>
필요할 때만 IP 주소를 할당받는 기술
2. NAT <br/>
여러 기기에서 하나의 IP 주소만 사용하는 방식
3. IPv6 <br/>
새로운 IP 버진

## ⭐ 네트워크 부분과 호스트 부분 구분 방법
1. 클래스
2. CIDR

